generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String     @id @default(cuid())
  loginAddress String     @unique
  createdAt    DateTime   @default(now())

  @@map("users")
}

model BlackjackSession {
  id             String                 @id @default(uuid())
  walletAddress  String
  seatId         Int
  buyInAmountWei String
  bankrollWei    String
  status         BlackjackSessionStatus
  createdAt      DateTime               @default(now())
  updatedAt      DateTime               @updatedAt

  hands          BlackjackHand[]

  @@index([walletAddress])
  @@map("blackjack_sessions")
}

model BlackjackHand {
  id           String               @id @default(uuid())
  sessionId    String
  betAmountWei String
  stateJson    Json
  outcome      BlackjackHandOutcome
  payoutWei    String
  createdAt    DateTime             @default(now())

  session      BlackjackSession     @relation(fields: [sessionId], references: [id])

  @@index([sessionId])
  @@map("blackjack_hands")
}

enum BlackjackSessionStatus {
  OPEN
  CLOSED
}

enum BlackjackHandOutcome {
  PENDING
  PLAYER_WIN
  DEALER_WIN
  PUSH
  BLACKJACK
  BUST
  SURRENDER
}
