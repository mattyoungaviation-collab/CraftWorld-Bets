generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String     @id @default(cuid())
  loginAddress String     @unique
  createdAt    DateTime   @default(now())

  @@map("users")
}

model BlackjackSession {
  id           String   @id @default(cuid())
  walletAddress String
  seatId       Int
  status       String
  buyInWei     BigInt
  bankrollWei  BigInt
  committedWei BigInt
  netPnlWei    BigInt
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  settlements  BlackjackSettlement[]

  @@index([walletAddress])
  @@map("blackjack_sessions")
}

model BlackjackSettlement {
  id            String   @id @default(cuid())
  sessionId     String
  betId         String
  txHash        String
  netPnlWei     BigInt
  status        String
  createdAt     DateTime @default(now())

  session       BlackjackSession @relation(fields: [sessionId], references: [id])

  @@unique([sessionId])
  @@map("blackjack_settlements")
}

model BlackjackTableState {
  id        String   @id
  state     Json
  updatedAt DateTime @updatedAt

  @@map("blackjack_table_state")
}
